{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/rahma/Documents/rahma/technical-test-pro-frontend/src/components/AppointmentForm.tsx\";\nimport { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Formik, Field, Form, ErrorMessage } from 'formik';\nimport { initValues } from 'consts/initValues';\nimport { filterPractitionersAction, getPractitioners } from 'store/practitioners';\nimport { Button, FormControl, Grid, InputLabel, OutlinedInput } from '@material-ui/core';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Alert from '@material-ui/lab/Alert';\nimport { filterPatientAction, getPatients } from 'store/patients';\nimport { AppointmentSchema } from 'consts/validationSchema';\nimport { addAppointment, getAppointmentRequest } from 'utils/formatAppointmentRequest';\nimport { getAppointments } from 'store/appointment';\nimport AvailabilitiesList from './AvailabilitiesList';\nimport { filteredPatients, filteredPractitioners } from 'utils/filterSelector';\n\nconst AppointmentForm = () => {\n  const dispatch = useDispatch();\n  const state = useSelector(state => state);\n  const practitioners = filteredPractitioners(state);\n  const patients = filteredPatients(state);\n  const {\n    0: availabilities,\n    1: setAvailabilities\n  } = useState([]);\n  const {\n    0: showSuccess,\n    1: setShowSuccess\n  } = useState(false);\n  useEffect(() => {\n    dispatch(getPractitioners());\n    dispatch(getPatients());\n  }, []);\n  useEffect(() => {\n    let hideAlert;\n\n    if (showSuccess) {\n      hideAlert = setTimeout(() => {\n        setShowSuccess(false);\n      }, 2000);\n    }\n\n    return () => {\n      clearTimeout(hideAlert);\n    };\n  }, [showSuccess]);\n\n  const PractitionersList = () => {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: practitioners.map(practitioner => {\n        return /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(Field, {\n            type: \"radio\",\n            name: \"practitionerId\",\n            value: practitioner.id.toString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 15\n          }, this), `${practitioner.firstName} ${practitioner.lastName}  (${practitioner.speciality})`]\n        }, practitioner.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false);\n  };\n\n  const PatientsList = () => {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: patients.map(patient => {\n        return /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(Field, {\n            type: \"radio\",\n            name: \"patientId\",\n            value: patient.id.toString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, this), `${patient.firstName} (${patient.lastName})`]\n        }, patient.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false);\n  };\n\n  const updateAppointmentList = () => {\n    setShowSuccess(true);\n    setAvailabilities([]);\n    dispatch(getAppointments());\n  };\n\n  const onSubmit = (values, {\n    resetForm\n  }) => {\n    let {\n      availabilityId,\n      patientId,\n      practitionerId\n    } = values;\n    let {\n      endDate,\n      startDate\n    } = availabilities.find(date => date.id == Number(availabilityId));\n    resetForm();\n    let body = getAppointmentRequest({\n      patientId,\n      practitionerId,\n      startDate,\n      endDate\n    });\n    addAppointment(body, updateAppointmentList);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: 50,\n        width: '90%',\n        margin: 'auto'\n      },\n      children: showSuccess && /*#__PURE__*/_jsxDEV(Alert, {\n        onClose: () => setShowSuccess(false),\n        severity: \"success\",\n        children: \"Appointment added successfully\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Formik, {\n      initialValues: initValues,\n      onSubmit: onSubmit,\n      validationSchema: AppointmentSchema,\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"_form\",\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            direction: \"column\",\n            className: \"list\",\n            id: \"patientlist\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"title\",\n              children: [\"Patient List\", /*#__PURE__*/_jsxDEV(ErrorMessage, {\n                component: \"span\",\n                name: \"patientId\",\n                className: \"error\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n              size: \"small\",\n              variant: \"outlined\",\n              style: {\n                width: '70%',\n                margin: '10px 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                htmlFor: \"outlined-adornment-amount\",\n                children: \"Patient Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                id: \"outlined-adornment-amount\",\n                onChange: e => {\n                  dispatch(filterPatientAction(e.target.value));\n                },\n                startAdornment: /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 35\n                }, this),\n                labelWidth: 100\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(PatientsList, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            direction: \"column\",\n            className: \"list\",\n            id: \"practitionerlist\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"title\",\n              children: [\"Practitioner List\", /*#__PURE__*/_jsxDEV(ErrorMessage, {\n                component: \"span\",\n                name: \"practitionerId\",\n                className: \"error\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n              size: \"small\",\n              variant: \"outlined\",\n              style: {\n                width: '70%',\n                margin: '10px 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                htmlFor: \"outlined-adornment-amount\",\n                children: \"Practitioner/speciality\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 201,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                id: \"outlined-adornment-amount\",\n                onChange: e => {\n                  dispatch(filterPractitionersAction(e.target.value));\n                },\n                startAdornment: /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 209,\n                  columnNumber: 35\n                }, this),\n                labelWidth: 170\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(PractitionersList, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            direction: \"column\",\n            className: \"list\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"title\",\n              children: [\"Appointments List\", /*#__PURE__*/_jsxDEV(ErrorMessage, {\n                component: \"span\",\n                name: \"availabilityId\",\n                className: \"error\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(AvailabilitiesList, {\n              availabilities: availabilities,\n              setAvailabilities: setAvailabilities\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          justify: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            variant: \"contained\",\n            className: \"btn\",\n            color: \"primary\",\n            size: \"medium\",\n            children: \"Book\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 5\n  }, this);\n};\n\nexport default AppointmentForm;","map":{"version":3,"sources":["/home/rahma/Documents/rahma/technical-test-pro-frontend/src/components/AppointmentForm.tsx"],"names":["useEffect","useState","useDispatch","useSelector","Formik","Field","Form","ErrorMessage","initValues","filterPractitionersAction","getPractitioners","Button","FormControl","Grid","InputLabel","OutlinedInput","SearchIcon","Alert","filterPatientAction","getPatients","AppointmentSchema","addAppointment","getAppointmentRequest","getAppointments","AvailabilitiesList","filteredPatients","filteredPractitioners","AppointmentForm","dispatch","state","practitioners","patients","availabilities","setAvailabilities","showSuccess","setShowSuccess","hideAlert","setTimeout","clearTimeout","PractitionersList","map","practitioner","id","toString","firstName","lastName","speciality","PatientsList","patient","updateAppointmentList","onSubmit","values","resetForm","availabilityId","patientId","practitionerId","endDate","startDate","find","date","Number","body","height","width","margin","e","target","value"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\nimport EditorLink from './EditorLink';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Formik, Field, Form, FormikHelpers, ErrorMessage } from 'formik';\nimport { InitValues, initValues } from 'consts/initValues';\nimport {\n  filterPractitionersAction,\n  getPractitioners,\n  practitionersSelectors,\n} from 'store/practitioners';\nimport {\n  Button,\n  FormControl,\n  Grid,\n  InputLabel,\n  OutlinedInput,\n} from '@material-ui/core';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Alert from '@material-ui/lab/Alert';\nimport {\n  filterPatientAction,\n  getPatients,\n  patientsSelectors,\n} from 'store/patients';\nimport { AppointmentSchema } from 'consts/validationSchema';\nimport {\n  addAppointment,\n  getAppointmentRequest,\n} from 'utils/formatAppointmentRequest';\nimport { getAppointments } from 'store/appointment';\nimport AvailabilitiesList from './AvailabilitiesList';\nimport { filteredPatients, filteredPractitioners } from 'utils/filterSelector';\n\nexport type Availability = {\n  id: number;\n  practitionerId: number;\n  startDate: string;\n  endDate: string;\n};\n\nconst AppointmentForm = () => {\n  const dispatch = useDispatch();\n\n  const state = useSelector((state) => state);\n  const practitioners = filteredPractitioners(state);\n  const patients = filteredPatients(state);\n\n  const [availabilities, setAvailabilities] = useState<Availability[]>([]);\n\n  const [showSuccess, setShowSuccess] = useState(false);\n\n  useEffect(() => {\n    dispatch(getPractitioners());\n    dispatch(getPatients());\n  }, []);\n\n  useEffect(() => {\n    let hideAlert;\n    if (showSuccess) {\n      hideAlert = setTimeout(() => {\n        setShowSuccess(false);\n      }, 2000);\n    }\n\n    return () => {\n      clearTimeout(hideAlert);\n    };\n  }, [showSuccess]);\n\n  const PractitionersList = () => {\n    return (\n      <>\n        {practitioners.map((practitioner) => {\n          return (\n            <label key={practitioner.id}>\n              <Field\n                type=\"radio\"\n                name=\"practitionerId\"\n                value={practitioner.id.toString()}\n              />\n              {`${practitioner.firstName} ${practitioner.lastName}  (${practitioner.speciality})`}\n            </label>\n          );\n        })}\n      </>\n    );\n  };\n\n  const PatientsList = () => {\n    return (\n      <>\n        {patients.map((patient) => {\n          return (\n            <label key={patient.id}>\n              <Field\n                type=\"radio\"\n                name=\"patientId\"\n                value={patient.id.toString()}\n              />\n              {`${patient.firstName} (${patient.lastName})`}\n            </label>\n          );\n        })}\n      </>\n    );\n  };\n\n  const updateAppointmentList = () => {\n    setShowSuccess(true);\n    setAvailabilities([]);\n    dispatch(getAppointments());\n  };\n\n  const onSubmit = (values: InitValues, { resetForm }) => {\n    let { availabilityId, patientId, practitionerId } = values;\n    let { endDate, startDate } = availabilities.find(\n      (date) => date.id == Number(availabilityId),\n    );\n    resetForm();\n    let body = getAppointmentRequest({\n      patientId,\n      practitionerId,\n      startDate,\n      endDate,\n    });\n    addAppointment(body, updateAppointmentList);\n  };\n\n  return (\n    <div>\n      <div style={{ height: 50, width: '90%', margin: 'auto' }}>\n        {showSuccess && (\n          <Alert onClose={() => setShowSuccess(false)} severity=\"success\">\n            Appointment added successfully\n          </Alert>\n        )}\n      </div>\n      <Formik\n        initialValues={initValues}\n        onSubmit={onSubmit}\n        validationSchema={AppointmentSchema}\n      >\n        <Form>\n          <div className=\"_form\">\n            <Grid\n              container\n              direction=\"column\"\n              className=\"list\"\n              id=\"patientlist\"\n            >\n              <p className=\"title\">\n                Patient List\n                <ErrorMessage\n                  component=\"span\"\n                  name=\"patientId\"\n                  className=\"error\"\n                />\n              </p>\n\n              <FormControl\n                size=\"small\"\n                variant=\"outlined\"\n                style={{ width: '70%', margin: '10px 0' }}\n              >\n                <InputLabel htmlFor=\"outlined-adornment-amount\">\n                  Patient Name\n                </InputLabel>\n                <OutlinedInput\n                  id=\"outlined-adornment-amount\"\n                  onChange={(e) => {\n                    dispatch(filterPatientAction(e.target.value));\n                  }}\n                  startAdornment={<SearchIcon />}\n                  labelWidth={100}\n                />\n              </FormControl>\n\n              <PatientsList />\n            </Grid>\n\n            <Grid\n              container\n              direction=\"column\"\n              className=\"list\"\n              id=\"practitionerlist\"\n            >\n              <p className=\"title\">\n                Practitioner List\n                <ErrorMessage\n                  component=\"span\"\n                  name=\"practitionerId\"\n                  className=\"error\"\n                />\n              </p>\n\n              <FormControl\n                size=\"small\"\n                variant=\"outlined\"\n                style={{ width: '70%', margin: '10px 0' }}\n              >\n                <InputLabel htmlFor=\"outlined-adornment-amount\">\n                  Practitioner/speciality\n                </InputLabel>\n                <OutlinedInput\n                  id=\"outlined-adornment-amount\"\n                  onChange={(e) => {\n                    dispatch(filterPractitionersAction(e.target.value));\n                  }}\n                  startAdornment={<SearchIcon />}\n                  labelWidth={170}\n                />\n              </FormControl>\n\n              <PractitionersList />\n            </Grid>\n\n            <Grid container direction=\"column\" className=\"list\">\n              <p className=\"title\">\n                Appointments List\n                <ErrorMessage\n                  component=\"span\"\n                  name=\"availabilityId\"\n                  className=\"error\"\n                />\n              </p>\n              <AvailabilitiesList\n                availabilities={availabilities}\n                setAvailabilities={setAvailabilities}\n              />\n            </Grid>\n          </div>\n          <Grid container justify=\"center\">\n            <Button\n              type=\"submit\"\n              variant=\"contained\"\n              className=\"btn\"\n              color=\"primary\"\n              size=\"medium\"\n            >\n              Book\n            </Button>\n          </Grid>\n        </Form>\n      </Formik>\n    </div>\n  );\n};\n\nexport default AppointmentForm;\n"]},"metadata":{},"sourceType":"module"}